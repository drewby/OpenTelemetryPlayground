# ToDo Web Application
This is a simple web application that allows users to manage a to-do list. The application is built using the [Preact](https://preactjs.com/) library, which is a fast and lightweight alternative to React. The application communicates with a backend REST API to manage the to-do items and uses the [OpenTelemetry javascript SDK](https://github.com/open-telemetry/opentelemetry-js) to report traces to an OTLP endpoint.

# How it works
## Architecture
The application consists of a single page web app built with Preact that communicates with a backend REST API to manage to-do items. The backend API is hosted on a remote server and provides endpoints to create, read, update and delete to-do items. 

The API is instrumented [OpenTelemetry javascript SDK](https://github.com/open-telemetry/opentelemetry-js) to provide distributed tracing. The traces can be viewed using Jaeger, or any popular open-source tracing system.

## Functionality
The application allows users to manage a to-do list. Users can add new to-do items, mark items as complete, and delete items from the list. The to-do list is displayed on the main page along with a form to add new items. The main page also displays the ID of the last trace that was generated by the OpenTelemetry SDK. 

## Code structure
The application is divided into several files: 

### index.html
This file is a simple HTML file that includes the  application code (`todo.js`) and a CSS file (`style.css`). It contains two empty divs with the IDs `app` and `links`, which are used by the application to render the UI.

### style.css
This file degines the visual styling for the Todo app.

### config.js
This file contains the configuration settings for the application. The file defines four variables:

* `API_URL`: The Todo API server.
* `GRAFANA_URL`: The URL of the Grafana dashboard server.
* `JAEGER_URL`: The URL of the Jaeger tracing server.
* `OTEL_URL`: The endpoint for OpenTelemetry Protocol traces.
* `SERVICE_NAME`: The service name to assign to spans.

### todo.js
This file contains the main application code. It imports the necessary modules, including Preact, the OpenTelemetry tracing library, and the application configuration file (`config.js`). It defines the App component, which is the main component of the application. The `App` component is composed of four child components:

* `Header`: Renders the application header, which includes the title and the sign-in and sign-out buttons.
* `TodoList`: Renders the list of to-do items.
* `NewTodo`: Renders the form to add new to-do items.
* `LastTrace`: Renders the last trace ID generated by the application.

The App component also defines several functions that are used to interact with the backend API:

* `refreshTodos`: Fetches the list of to-do items and updates the state of the application.
* `addTodo`: Adds a new to-do item.
* `updateTodoIsComplete`: Marks a to-do item as complete or incomplete.
* `deleteTodo`: Deletes a to-do item.
* `onInputTodoName`: Updates the state of the application with the value of the new to-do item form input.

There is another component called `OtherLinks`, which displays links to external systems such as the API documentation and observability dashboards.

### trace.js 
This code configures distributed tracing for the web application using OpenTelemetry. The code initializes a tracer provider, exports spans to an OTLP endpoint, and registers instrumentations to automatically trace incoming and outgoing requests.

After configuring tracing, the library exports a `tracer` for starting new traces and the SDK `api` for setting context (parent traces, etc).

The SDK is configured with the `OTEL_URL` and `SERVICE_NAME` variables in `config.js`